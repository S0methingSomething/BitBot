{
  "tasks": [
    {
      "id": 1,
      "title": "Fix critical bug: sync.py calls non-existent unwrap_err()",
      "description": "The sync command calls result.unwrap_err() 5 times but the Result type doesn't have this method. This will crash at runtime when any error occurs.",
      "status": "pending",
      "priority": "high",
      "details": "Files: src/bitbot/commands/sync.py (lines 48, 53, 58, 63, 68) and src/bitbot/core/result.py. Either add unwrap_err() method to Err class that returns self.error, or change sync.py to use .error attribute directly.",
      "testStrategy": "Run sync command with invalid config to trigger error path and verify it doesn't crash"
    },
    {
      "id": 2,
      "title": "Remove duplicate model definitions",
      "description": "Both models.py and config_models.py define Config, GitHubConfig, and RedditConfig classes with different fields. This is confusing and error-prone.",
      "status": "pending",
      "priority": "high",
      "details": "config_models.py is the actual used Config (17 imports). Remove Config/GitHubConfig/RedditConfig from models.py, keep only BotState and PendingRelease there.",
      "testStrategy": "Verify all imports still work and no duplicate class definitions exist"
    },
    {
      "id": 3,
      "title": "Fix Result type incorrect signatures",
      "description": "Result type has several type signature issues that limit functionality and type safety.",
      "status": "pending",
      "priority": "high",
      "details": "In core/result.py: (1) Err.unwrap_or returns E but should return T, (2) Ok.map can't change types, should be Callable[[T], U] -> Ok[U], (3) Missing unwrap_err/expect/or_else methods, (4) Err.unwrap should return Never not None",
      "testStrategy": "Add type tests and runtime tests for all Result methods"
    },
    {
      "id": 4,
      "title": "Add type safety to Container",
      "description": "Container uses Any everywhere which defeats type checking purpose.",
      "status": "pending",
      "priority": "medium",
      "details": "In core/container.py: Add generic get method like get[T](name: str, service_type: type[T]) -> T to enable type-safe service retrieval",
      "testStrategy": "Verify type checker catches incorrect service type usage"
    },
    {
      "id": 5,
      "title": "Fix commands to use CLI context",
      "description": "Commands like sync.py set up their own container instead of using ctx.obj from main CLI.",
      "status": "pending",
      "priority": "medium",
      "details": "Commands should accept ctx: typer.Context parameter and use ctx.obj['container'] instead of calling setup_container() again. This enables sharing state and respecting verbose flag.",
      "testStrategy": "Verify commands receive and use container from CLI context"
    },
    {
      "id": 6,
      "title": "Add validation to Pydantic models",
      "description": "Config models lack validators for repo format, subreddit format, post_mode enum, and numeric constraints.",
      "status": "pending",
      "priority": "medium",
      "details": "Add validators: repo format (owner/repo), subreddit format, post_mode enum, days_before_new_post > 0, field descriptions in Field() calls",
      "testStrategy": "Test that invalid configs are rejected with clear error messages"
    },
    {
      "id": 7,
      "title": "Add standard CLI features",
      "description": "CLI lacks --version, logging config, typed context, and exception handler.",
      "status": "pending",
      "priority": "low",
      "details": "In cli.py: Add --version option, configure logging based on verbose flag, use TypedDict for ctx.obj, add global exception handler, enable shell completion",
      "testStrategy": "Test --version works, verbose flag enables debug logging"
    }
  ]
}
